
= JWT & Authentifizierung – Überblick & Snippets
:author: Almina Silnovic & Azra Özdemir
:revdate: 2025-04-14
:toc:
:icons: font

== Was ist JWT?
JWT steht für JSON Web Token. Es ist ein Token, der strukturierte Informationen (sogenannte Claims) enthält und oft für Authentifizierung und Autorisierung verwendet wird.

=== Authentifizierung vs Autorisierung

Authentifizierung: **„Wer bist du?“** – Der Prozess, bei dem ein Benutzer nachweist, wer er ist. Z.B. durch Eingabe von Benutzernamen & Passwort

Autorisierung: **„Was darfst du tun?“** – Der Prozess, bei dem geprüft wird, auf welche Ressourcen der authentifizierte Benutzer zugreifen darf. Z.B. auf welches Bankkonto darfst du zugreifen?

=== Aufbau
[source]
----
<Header>.<Payload>.<Signature>
----

Ein JWT wird nach erfolgreicher Authentifizierung erstellt
und dient dann zur Autorisierung bei jeder weiteren Anfrage.

== Ablauf: Auth mit JWT

1. User loggt sich ein: Der Benutzer schickt einen Request mit POST an den Server, der die Anmeldedaten enthält.
2. Server gibt JWT zurück: Nach erfolgreicher Anmeldung erstellt der Server ein JWT und schickt eine Response an den Client.
3. Client speichert Token: Der Client speichert das JWT, um es später zu verwenden.
4. Client sendet Token mit: Bei weiteren Requests schickt der Client das JWT an den Server.
5. Server prüft Token: Der Server prüft das JWT, indem er...
    - die Signatur validiert **(wurden die Daten verändert?)**,
    - das Ablaufdatum prüft **(ist der Token noch gültig und nicht abgelaufen?)**
    - und sicherstellt, dass der Benutzer die nötigen Berechtigungen hat.

Wenn alles passt, gewährt der Server Zugriff.

== Vorteile

== Nachteile


== Code-Snippets (Node.js + Express)

JWT erstellen:

[source,js]
----
const jwt = require("jsonwebtoken");

const token = jwt.sign({ userId: 123 }, "secretKey", { expiresIn: "1h" });
console.log(token);
----

JWT prüfen (Middleware):

[source,js]
----
function verifyToken(req, res, next) {
  const token = req.headers["authorization"]?.split(" ")[1];
  if (!token) return res.status(401).send("No token provided");

  jwt.verify(token, "secretKey", (err, decoded) => {
    if (err) return res.status(403).send("Invalid token");
    req.userId = decoded.userId;
    next();
  });
}
----